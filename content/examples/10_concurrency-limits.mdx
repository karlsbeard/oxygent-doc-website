---
title: Limit Concurrency
description: The following uses character matching for simulation. In production environments, typically retrieve top-K relevant content from knowledge base based on query, and can add multi-path retrieval logic
---

## Overview

This example demonstrates limit concurrency in OxyGent.

## Code

```python
import os
from oxygent import MAS, oxy
from pydantic import Field

jd_docs_fh = oxy.FunctionHub(name="jd_docs_tools")

@jd_docs_fh.tool(description="A tool that can retrieve JD-related knowledge")
def retrieval(query: str = Field(description="What aspect of knowledge")) -> str:
    """The following uses character matching for simulation. In production environments, typically retrieve top-K relevant content from knowledge base based on query, and can add multi-path retrieval logic"""
    knowledage_dict = {
        "211_delivery": "**JD 211 Delivery Service**: Orders placed before 11:00 AM (or 10:00 AM in some cities) are delivered the same day; orders placed before 11:00 PM are delivered by 3:00 PM the next day. (Note: Timing starts from order submission for in-stock orders, and from payment completion for prepaid orders)",
        "mission": "JD's mission is 'Technology for a Better Life'.",
        "vision": "JD's vision is to become the world's most trusted company.",
        "values": "JD's core values are: Customer First, Innovation, Fighting Spirit, Responsibility, Gratitude, and Integrity.",
    }
    return "\n\n".join([v for k, v in knowledage_dict.items() if k in query])

oxy_space = [
    oxy.HttpLLM(
        name="default_llm",
        api_key=os.getenv("DEFAULT_LLM_API_KEY"),
        base_url=os.getenv("DEFAULT_LLM_BASE_URL"),
        model_name=os.getenv("DEFAULT_LLM_MODEL_NAME"),
        llm_params={"temperature": 0.1},
        semaphore=4,   # Limit concurrency
    ),
    jd_docs_fh,
    oxy.ReActAgent(
        name="QA_agent",
        llm_model="default_llm",
        tools=["jd_docs_tools"],
    ),
]

async def main():
    async with MAS(oxy_space=oxy_space) as mas:
        querys = [
            "What is JD's 211 delivery service?",
            "What is JD's 35711",
            "What is JD's 3.5 Mao theory",
            "What are JD's values",
            "What is JD's mission",
            "What are JD's three strategic questions",
            "What is JD's vision",
        ]
        answers = await mas.start_batch_processing(querys)
        for query, answer in zip(querys, answers):
            print("-" * 100)
            print("Q:", query)
            print("A:", answer)

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())
```

## Key Points

- This example shows how to use OxyGent for limit concurrency
- Follow the code comments for detailed explanations
- Make sure to set up your environment variables before running

## Running the Example

To run this example:

```bash
python 10_concurrency_limits.py
```
